# 活动连续记录与统计功能设计

## 需求分析

根据用户需求，我们需要实现以下功能：

1. **活动连续记录功能**：当用户再次输入相同的活动名称时，系统应承接上次的时间点继续记录，而不是创建全新的活动记录
2. **独立时间段记录**：每次点击"结束"按钮时，系统应记录该时间段作为一个独立的记录
3. **分类统计功能**：
   - 每日统计：统计每天特定活动（如"编程"）的时间
   - 累计统计：统计所有时间内特定活动的总时间

## 技术设计

### 1. 数据结构修改

需要修改现有的数据结构，以支持活动的连续记录和分类统计：

```javascript
// 活动记录结构
{
  id: "唯一ID",
  activityName: "活动名称",
  startTime: Date对象,
  endTime: Date对象,
  duration: 分钟数,
  continuedFrom: "上一次活动ID" // 新增字段，用于标记连续活动
}

// 活动统计结构
{
  activityName: "活动名称",
  dailyStats: {
    "2025-04-15": 分钟数,
    "2025-04-16": 分钟数,
    // 其他日期...
  },
  totalMinutes: 总分钟数
}
```

### 2. 功能实现方案

#### 2.1 活动连续记录功能

1. 修改`startActivity`函数，检查输入的活动名称是否与之前的活动相同
2. 如果相同，记录连续关系（通过`continuedFrom`字段）
3. 在UI中显示活动是连续的，并显示累计时间

#### 2.2 独立时间段记录

1. 保持现有的`endActivity`函数逻辑，确保每次点击"结束"按钮时创建独立记录
2. 在记录中添加连续关系标记

#### 2.3 分类统计功能

1. 创建新的统计函数，用于计算每日和累计统计数据
2. 修改现有的图表显示，添加切换选项：
   - 显示当日所有活动分布
   - 显示特定活动的每日分布
   - 显示特定活动的累计时间

### 3. UI修改

1. 在统计区域添加切换选项，允许用户选择查看方式：
   - "当日活动分布"（现有功能）
   - "活动每日统计"（新功能）
   - "活动累计统计"（新功能）
2. 在活动记录中显示连续关系标记

## 实现步骤

1. 修改数据结构，添加连续关系字段
2. 更新活动开始和结束逻辑
3. 实现分类统计功能
4. 更新UI以支持新功能
5. 更新数据存储和加载逻辑
6. 测试新功能
7. 更新文档
