# 数据导出/导入功能设计

## 功能需求

用户需要能够：
1. 将当前的时间记录数据导出为文件保存到本地
2. 在需要时导入之前导出的数据文件
3. 在导入时有选项决定是否保留当前数据

## UI设计

### 导出/导入按钮位置
在应用顶部导航栏添加两个新按钮：
- "导出数据" - 用于将当前数据导出为JSON文件
- "导入数据" - 用于从JSON文件导入数据

### 导入对话框
导入时显示一个模态对话框，包含：
- 文件选择器 - 允许用户选择要导入的JSON文件
- 数据合并选项 - 单选按钮，选择"替换当前数据"或"合并到当前数据"
- 确认和取消按钮

## 数据结构

导出的JSON文件将包含以下结构：
```json
{
  "version": "1.0",
  "exportDate": "2025-04-15T05:30:00.000Z",
  "data": {
    "activities": [...],
    "currentActivity": {...}
  }
}
```

- `version`: 数据格式版本号，用于未来兼容性检查
- `exportDate`: 导出时间戳
- `data`: 包含实际的应用数据
  - `activities`: 活动记录数组
  - `currentActivity`: 当前进行中的活动（如果有）

## 功能流程

### 导出流程
1. 用户点击"导出数据"按钮
2. 系统从localStorage获取当前数据
3. 系统将数据格式化为JSON，添加版本号和导出时间
4. 系统生成可下载的JSON文件
5. 浏览器触发文件下载，默认文件名为"time_tracker_data_YYYY-MM-DD.json"

### 导入流程
1. 用户点击"导入数据"按钮
2. 系统显示导入对话框
3. 用户选择JSON文件并选择导入模式（替换或合并）
4. 用户点击确认按钮
5. 系统读取并解析JSON文件
6. 系统验证数据格式和版本兼容性
7. 根据用户选择的模式，系统替换或合并数据
8. 系统将更新后的数据保存到localStorage
9. 系统刷新页面以显示导入的数据
10. 显示导入成功消息

## 错误处理

系统将处理以下错误情况：
1. 文件格式错误 - 非JSON文件或JSON格式不正确
2. 数据结构不兼容 - 缺少必要字段或结构不匹配
3. 版本不兼容 - 数据版本高于当前应用版本
4. 文件读取错误 - 文件损坏或无法读取

对于每种错误，系统将显示适当的错误消息，并不会修改当前数据。

## 安全考虑

1. 所有数据处理都在客户端完成，不涉及服务器交互
2. 导入前验证数据结构，防止恶意数据破坏应用
3. 不处理敏感个人信息，仅处理用户的活动记录数据
